<!DOCTYPE html>
<html>
<head>
<title>Kegarator Monitor</title>
<link rel="stylesheet" type="text/css" href="css/kegarator.css"/>
</head>
 
<body onload="connect()">

<script src="common.js"></script>

<script>

  var wWebSocket;

  function connect()
  {
    try
    {
      wWebSocket = new WebSocket(QueryString.server);
    }
    catch (exc)
    {
      console.log(exc.message);
    }
    wWebSocket.onopen = function (evt) { greetings(evt); };
    wWebSocket.onmessage = function (evt) { parseMessage(evt); };
  }

  function greetings(evt)
  {
    wWebSocket.send("get_status");
  }

  function parseMessage(evt)
  {
    console.log(evt.data);
    var wSplit = evt.data.split(",");
  }
  //--><!]]>
</script>

<table>
  <tr>

    <td class="text_data">
      <table>
        <tr>
          <td class="temperature">4.3</td>
          <td class="degree_c">&deg;C</td>
        </tr>
        <tr>
          <td class="pressure">102.1</td>
          <td class="kpa">kPa</td>
        </tr>
      </table>
    </td>

    <td class="kegs">
      <div class="parent">

        <img src="http://192.168.0.103/kegarator/KegEmpty.png" />
        <canvas id="beer_level_keg_0" width="198" height="581" class="beer_level"></canvas>
        <script>
          var canvas = document.getElementById('beer_level_keg_0');
          var context = canvas.getContext('2d');

          context.beginPath();
          var level_pct = 0.3;
          var level_px = -420 * level_pct + 522;
          context.rect(25, level_px, 150, 522 - level_px);
          context.fillStyle = 'yellow';
          context.fill();

        </script>
      </div>
    </td>

    <td>
      <div class="parent">
        <img src="http://192.168.0.103/kegarator/KegEmpty.png" />
        <canvas id="beer_level_keg_1" width="198" height="581" class="beer_level"></canvas>
        <script>
          var canvas = document.getElementById('beer_level_keg_1');
          var context = canvas.getContext('2d');

          context.beginPath();
          var level_pct = 0.8;
          var level_px = -420 * level_pct + 522;
          context.rect(25, level_px, 150, 522 - level_px);
          context.fillStyle = 'brown';
          context.fill();

        </script>
      </div>
    </td>

  </tr>
</table>

</body>
</html>
